(()=>{var e=jQuery("#modalSearch"),t="#local-search-input",r="#local-search-result";e.on("show.bs.modal",(function(){var e=CONFIG.search_path||"/local-search.xml",l=r,s=jQuery(t),a=jQuery(l);if(0===s.length)throw Error("No element selected by the searchSelector");if(0===a.length)throw Error("No element selected by the resultSelector");-1===a.attr("class").indexOf("list-group-item")&&a.html('<div class="m-auto text-center"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div><br/>Loading...</div>'),jQuery.ajax({url:e,dataType:"xml",success:function(e){var t=jQuery("entry",e).map((function(){return{title:jQuery("title",this).text(),content:jQuery("content",this).text(),url:jQuery("url",this).text()}})).get();-1===a.html().indexOf("list-group-item")&&a.html(""),s.on("input",(function(){var e=s.val(),r="",l=e.trim().toLowerCase().split(/[\s-]+/);return a.html(""),e.trim().length<=0?s.removeClass("invalid").removeClass("valid"):(t.forEach((function(e){var t,s,a=!0,i=(e.title&&""!==e.title.trim()||(e.title="Untitled"),e.title.trim()),n=i.toLowerCase(),o=e.content.trim().replace(/<[^>]+>/g,""),c=o.toLowerCase(),h=(e=e.url,-1),u=-1;CONFIG.include_content_in_search&&""===c?a=!1:l.forEach((function(e,r){t=n.indexOf(e),h=c.indexOf(e),t<0&&h<0?a=!1:(h<0&&(h=0),0===r&&(u=h))})),a&&(r+="<a href='"+e+"' class='list-group-item list-group-item-action font-weight-bolder search-list-title'>"+i+"</a>",e=o,0<=u)&&(i=u+80,(i=0===(o=(o=u-20)<0?0:o)?100:i)>e.length&&(i=e.length),s=e.substring(o,i),l.forEach((function(e){var t=new RegExp(e,"gi");s=s.replace(t,'<span class="search-word">'+e+"</span>")})),r+="<p class='search-list-content'>"+s+"...</p>")})),-1===r.indexOf("list-group-item")?s.addClass("invalid").removeClass("valid"):(s.addClass("valid").removeClass("invalid"),void a.html(r)))}))}})})),e.on("shown.bs.modal",(function(){jQuery("#local-search-input").focus()})),e.on("hidden.bs.modal",(function(){var e=t,l=r;if(e=jQuery(e),l=jQuery(l),0===e.length)throw Error("No element selected by the searchSelector");if(0===l.length)throw Error("No element selected by the resultSelector");e.val("").removeClass("invalid").removeClass("valid"),l.html("")}))})();