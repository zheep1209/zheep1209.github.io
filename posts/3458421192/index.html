<!DOCTYPE html><html lang=zh-CN data-default-color-scheme=auto><head><meta charset=UTF-8><link rel=apple-touch-icon sizes=76x76 href=https://zheep.oss-cn-beijing.aliyuncs.com/blog/uuz.jpg><link rel=icon href=https://zheep.oss-cn-beijing.aliyuncs.com/blog/uuz.jpg><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=color-scheme content="light dark"><meta name=theme-color content=#fff><meta name=author content=西行寺岩羊><meta name=keywords content="Spring, Controller层, Service层, Mapper层, 注解, 接口编程, MyBatis, 动态SQL, 注册登录, 后端开发"><meta name=description content=本文详细讲解了Spring框架中Controller层、Service层和Mapper层的分工与协作，通过注册登录功能示例展示了注解的使用、接口编程思想、MyBatis操作数据库以及动态SQL多条件查询等核心后端开发技术。><meta property=og:type content=article><meta property=og:title content=Spring：整体思路讲解><meta property=og:url content=https://www.zheep.top/posts/3458421192/index.html><meta property=og:site_name content="云端的解构者 | 西行寺岩羊的博客"><meta property=og:description content=本文详细讲解了Spring框架中Controller层、Service层和Mapper层的分工与协作，通过注册登录功能示例展示了注解的使用、接口编程思想、MyBatis操作数据库以及动态SQL多条件查询等核心后端开发技术。><meta property=og:locale content=zh_CN><meta property=article:published_time content=2025-05-06T09:42:59.000Z><meta property=article:modified_time content=2025-05-19T13:09:28.402Z><meta property=article:author content=西行寺岩羊><meta property=article:tag content=网站><meta name=twitter:card content=summary_large_image><meta name=referrer content=no-referrer-when-downgrade><title>Spring：整体思路讲解 - 云端的解构者 | 西行寺岩羊的博客</title><link rel=stylesheet href=https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css><link rel=stylesheet href=https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css><link rel=stylesheet href=https://lib.baomitu.com/hint.css/2.7.0/hint.min.css><link rel=stylesheet href=https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css><link rel=stylesheet href=//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css><link rel=stylesheet href=//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css><link rel=stylesheet href=/css/main.css><link id=highlight-css rel=stylesheet href=/css/highlight.css><link id=highlight-css-dark rel=stylesheet href=/css/highlight-dark.css><link rel=stylesheet href=/css/critical.css><script id=fluid-configs>var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"www.zheep.top",root:"/",version:"1.9.8",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,follow_dnt:!0,baidu:"https://hm.baidu.com/hm.js?8f39630134aebd7491ea0c6ea1e0664e",google:{measurement_id:null},tencent:{sid:null,cid:null},leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1},umami:{src:null,website_id:null,domains:null,start_time:"2024-01-01T00:00:00.000Z",token:null,api_server:null}},search_path:"/local-search.xml",include_content_in_search:!0});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src=/js/utils.js></script><script src=/js/color-schema.js></script><script defer=defer src=https://cloud.umami.is/script.js data-website-id=5e55d967-0b5e-47bb-8c0f-32270d575bb3></script><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title="云端的解构者 | 西行寺岩羊的博客" type=application/atom+xml><link rel=alternate href=/rss2.xml title="云端的解构者 | 西行寺岩羊的博客" type=application/rss+xml></head><body><div id=web_bg></div><header><div class=header-inner style=height:100vh><nav id=navbar class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class=container><a class=navbar-brand href=/ ><strong>西行寺岩羊</strong> </a><button id=navbar-toggler-btn class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation"><div class=animated-icon><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto text-center"><li class=nav-item><a class=nav-link href=/ target=_self><span>/ 首页</span></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" target=_self href=javascript:; role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>/ 文章</span></a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/archives/ target=_self><span>归档</span> </a><a class=dropdown-item href=/categories/ target=_self><span>分类</span> </a><a class=dropdown-item href=/tags/ target=_self><span>标签</span></a></div></li><li class=nav-item><a class=nav-link href=/photo/ target=_self><span>/ 照片墙</span></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" target=_self href=javascript:; role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>/ 我的</span></a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/about/ target=_self><span>关于</span> </a><a class=dropdown-item href=/steam/ target=_self><span>steam</span></a></div></li><li class=nav-item><a class=nav-link href=/links/ target=_self><span>/ 友人帐</span></a></li><li class=nav-item><a class=nav-link href=/message/ target=_self><span>/ 留言板</span></a></li><li class=nav-item><a class=nav-link href=http://lab.zheep.top target=_self><span>/ 实验室</span></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" target=_self href=javascript:; role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>/ 博客接力</span></a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=https://www.travellings.cn/go.html target=_self><span>开往</span> </a><a class=dropdown-item href=https://www.foreverblog.cn/go.html target=_self><span>虫洞</span> </a><a class=dropdown-item href=https://www.blogsclub.org/go target=_self><span>空间穿梭</span> </a><a class=dropdown-item href=https://suiji.ru/ target=_self><span>随机博客</span> </a><a class=dropdown-item href=https://www.boyouquan.com/planet-shuttle target=_self><span>星球穿梭</span></a></div></li><li class=nav-item id=search-btn><a class=nav-link target=_self href=javascript:; data-toggle=modal data-target=#modalSearch aria-label=Search><i class="iconfont icon-search"></i></a></li><li class=nav-item id=color-toggle-btn><a class=nav-link target=_self href=javascript:; aria-label="Color Toggle"><i class="iconfont icon-dark" id=color-toggle-icon></i></a></li></ul></div></div></nav><div id=banner class=banner false style="background:url(/) no-repeat center center;background-size:cover"><div class=full-bg-img><div class="mask flex-center" style=background-color:rgba(0,0,0,.3)><div class="banner-text text-center fade-in-up"><div class=h2><span id=subtitle data-typed-text=Spring：整体思路讲解></span></div><div class=mt-3><span class=post-meta><i class="iconfont icon-date-fill" aria-hidden=true></i> <time datetime="2025-05-06 17:42" pubdate>2025年5月6日 下午</time></span></div><div class=mt-1><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 3.6k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 30 分钟 </span><span id=busuanzi_container_page_pv style=display:none><i class="iconfont icon-eye" aria-hidden=true></i> <span id=busuanzi_value_page_pv></span> 次</span></div></div><div class=scroll-down-bar><i class="iconfont icon-arrowdown"></i></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id=board-ctn><div id=board><article class="post-content mx-auto"><h1 id=seo-header>Spring：整体思路讲解</h1><div class=markdown-body><h1 id=Spring：整体思路讲解><a href=#Spring：整体思路讲解 class=headerlink title=Spring：整体思路讲解></a>Spring：整体思路讲解</h1><h2 id=Spring整体思路讲解><a href=#Spring整体思路讲解 class=headerlink title=Spring整体思路讲解></a>Spring整体思路讲解</h2><p>后端，说白了就是围绕数据库做增删查改：从数据库中获取数据，处理后返回给前端；或者接收前端传来的数据，处理后存入数据库。这样前后端协同，项目就能跑起来。</p><p>比如实现一个注册登录功能：</p><ul><li><p><strong>注册</strong>：用户填写手机号、邮箱、密码等信息，前端传给后端。后端用一个“用户注册类”接收这些字段，然后将其存入数据库的用户表中。</p></li><li><p><strong>登录</strong>：用户输入账号密码，后端接收后去数据库查询，先判断用户名是否存在，再比对密码是否正确。匹配成功就登录成功，否则返回错误提示。</p></li></ul><p>看起来就是简单的数据交互，但实际上后端远不止这些。</p><p>真正复杂的地方在于“<strong>如何管理用户状态与系统安全</strong>”：</p><ul><li><p>用户登录后，如何让系统知道“这个请求是谁发的”？</p></li><li><p>用户没登录，却直接访问别人主页的链接，要如何阻止？</p></li><li><p>用户登录之后要返回什么信息给前端？Token？Session？</p></li><li><p>后端是要每次都手写判断，还是有统一拦截机制来管理这些权限？</p></li><li><p>数据库压力大时如何优化查询？怎么加缓存？用户量大了怎么拆服务？</p></li><li><p>日志怎么打？异常怎么监控？接口怎么设计才能稳、扩展性强？</p></li></ul><p>这些问题构成了<strong>后端的核心价值</strong>：权限控制、接口设计、缓存优化、消息队列、负载均衡、日志管理、安全校验、服务拆分……Spring看起来“复杂”，其实就是把这些基础能力都封装好了，让我们不用重复造轮子</p><h2 id=如何用Spring的语言操作这些东西><a href=#如何用Spring的语言操作这些东西 class=headerlink title=如何用Spring的语言操作这些东西></a>如何用Spring的语言操作这些东西</h2><h3 id=首先我们先解决增删查改的问题><a href=#首先我们先解决增删查改的问题 class=headerlink title=首先我们先解决增删查改的问题></a>首先我们先解决增删查改的问题</h3><p>现在程序的核心思想就是解耦，什么是解耦呢，就是把不同模块的功能分开进行处理，比如和前端打交道的模块，处理数据的模块，以及和数据库打交道的模块，还有单独用来<br><strong>存储数据</strong>的类<br>这些模块分别叫做<br>Controller 层（控制层）<br>Service 层（服务层）<br>Repository 层 &#x2F; DAO 层（数据访问层）现在叫Mapper（以后会说为什么，有什么区别）（挖坑<br>Entity &#x2F; POJO &#x2F; DTO</p><p>接下来我们按照接收数据，处理数据，数据库交互的思路来进行讲解</p><h4 id=Controller-层（控制层）><a href=#Controller-层（控制层） class=headerlink title="Controller 层（控制层）"></a>Controller 层（控制层）</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-meta>@RestController</span><br><span class=hljs-meta>@RequestMapping(&quot;/user&quot;)</span><br><span class=hljs-keyword>public</span> <span class=hljs-keyword>class</span> <span class="hljs-title class_">UserController</span> &#123;<br><br>    <span class=hljs-meta>@Autowired</span><br>    <span class=hljs-keyword>private</span> UserService userService;<br><br>    <span class=hljs-meta>@PostMapping(&quot;/register&quot;)</span><br>    <span class=hljs-keyword>public</span> Result <span class="hljs-title function_">register</span><span class=hljs-params>(<span class=hljs-meta>@RequestBody</span> UserDTO userDTO)</span> &#123;<br>        <span class=hljs-keyword>return</span> userService.register(userDTO);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>看到这个代码初学者指定懵逼了<br>@RestController这些是什么，这是注解，Java自带的语言特性，贴个代码你就想起来了</p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-keyword>public</span> <span class=hljs-keyword>class</span> <span class="hljs-title class_">Demo</span> &#123;<br>    <span class=hljs-meta>@Override</span><br>    <span class=hljs-keyword>public</span> String <span class="hljs-title function_">toString</span><span class=hljs-params>()</span> &#123;<br>        <span class=hljs-keyword>return</span> <span class=hljs-string>&quot;这是个重写&quot;</span>;<br>    &#125;<br><br>    <span class=hljs-meta>@Deprecated</span><br>    <span class=hljs-keyword>public</span> <span class=hljs-keyword>void</span> <span class="hljs-title function_">oldMethod</span><span class=hljs-params>()</span> &#123;<br>        System.out.println(<span class=hljs-string>&quot;不建议再用我了&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Spring 和很多框架是<strong>基于 Java 原生注解机制</strong>，自定义了大量注解，比如：</p><table><thead><tr><th>注解</th><th>作用</th><th>举例</th></tr></thead><tbody><tr><td><code>@RestController</code></td><td>声明这个类是一个 REST 接口类（自动返回 JSON）</td><td>贴在类上</td></tr><tr><td><code>@RequestMapping(&quot;/user&quot;)</code></td><td>给这个类或方法绑定访问路径</td><td>可写在类或方法上</td></tr><tr><td><code>@PostMapping(&quot;/register&quot;)</code></td><td>绑定 POST 请求的具体路径</td><td>只贴在方法上</td></tr><tr><td><code>@RequestBody</code></td><td>把 JSON 转成 Java 对象</td><td>用在参数前</td></tr><tr><td><code>@GetMapping</code>, <code>@DeleteMapping</code>, <code>@PutMapping</code></td><td>对应不同的 HTTP 请求</td><td>类似 PostMapping</td></tr></tbody></table><p>这些不用一个个记忆，我们结合代码就方便理解了</p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-meta>@RestController</span> <span class=hljs-comment>// 这是个对外暴露的接口类</span><br><span class=hljs-meta>@RequestMapping(&quot;/user&quot;)</span> <span class=hljs-comment>// 所有路径都以 /user 开头</span><br><span class=hljs-keyword>public</span> <span class=hljs-keyword>class</span> <span class="hljs-title class_">UserController</span> &#123;<br><br>    <span class=hljs-meta>@PostMapping(&quot;/register&quot;)</span> <span class=hljs-comment>// 注册接口，POST 请求</span><br>    <span class=hljs-keyword>public</span> String <span class="hljs-title function_">register</span><span class=hljs-params>(<span class=hljs-meta>@RequestBody</span> UserDTO userDTO)</span> &#123;<br>        <span class=hljs-keyword>return</span> <span class=hljs-string>&quot;注册成功：&quot;</span> + userDTO.getUsername();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id=PostMapping是什么？><a href=#PostMapping是什么？ class=headerlink title=PostMapping是什么？></a>PostMapping是什么？</h5><h5 id=接口是什么？><a href=#接口是什么？ class=headerlink title=接口是什么？></a>接口是什么？</h5><p>Controller层和前端打交道所使用的方式就是接口<br>上文中的RequestMapping(“&#x2F;user”)是UserController接口类的一个接口“根”路径<br>@PostMapping(“&#x2F;register”)是一个post类型的接口<br>简单讲就是当前端请求「服务器地址+&#x2F;user&#x2F;register」的时候，后端就会自动识别到这个请求，然后执行@PostMapping(“&#x2F;register”) 下面的方法<br>可以理解为遥控器的按钮，当按下“音量+”的时候，电视的音量就会升高。</p><h5 id=如何引入Service层？><a href=#如何引入Service层？ class=headerlink title=如何引入Service层？></a>如何引入Service层？</h5><h6 id=三种方式><a href=#三种方式 class=headerlink title=三种方式></a>三种方式</h6><p><strong><code>@Autowired</code></strong> 注解是 Spring 中用来自动注入依赖的常见方式，我们先使用字段注入，后期对这三种方式进行细说（挖坑<br>1.1 <strong>构造器注入（推荐方式）</strong><br>1.2 <strong>字段注入（最常见的方式）</strong><br>1.3 <strong>Setter 方法注入</strong></p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-meta>@Autowired</span><br><span class=hljs-keyword>private</span> UserService userService;<br></code></pre></td></tr></table></figure><h6 id=UserService是怎么被发现的？><a href=#UserService是怎么被发现的？ class=headerlink title=UserService是怎么被发现的？></a>UserService是怎么被发现的？</h6><p>这不得不提<strong>注解</strong>的知识了<br>当我们使用 <code>@Component</code>及其衍生注解<code>@Service</code>、<code>@Repository</code>、<code>@Controller</code>的时候，Spring 会自动扫描指定包下的类，并根据这些注解将它们注册为<br>Spring 管理的 Bean，这一系列操作也就是<strong>Spring 的组件扫描（Component Scanning）</strong>（挖坑</p><h5 id=怎么返回值？><a href=#怎么返回值？ class=headerlink title=怎么返回值？></a>怎么返回值？</h5><p>前端通常接收到的数据为：</p><figure class="highlight json"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre></td><td class=code><pre><code class="hljs json"><span class=hljs-punctuation>&#123;</span><br>  code<span class=hljs-punctuation>:</span> <span class=hljs-number>1</span><br>  <span class=hljs-attr>&quot;msg&quot;</span><span class=hljs-punctuation>:</span> <span class=hljs-string>&quot;success&quot;</span><br>  <span class=hljs-attr>&quot;data&quot;</span><span class=hljs-punctuation>:</span> <span class=hljs-punctuation>&#123;</span><br>    xxx<br>  <span class=hljs-punctuation>&#125;</span><br><span class=hljs-punctuation>&#125;</span><br></code></pre></td></tr></table></figure><p>在我们的第一个代码示例中出现了@RestController注解<br>它是 <strong>@RestController</strong> 和 <strong>@ResponseBody</strong>的合成注解<br><strong>@RestController</strong>的作用就是方法返回的对象会自动转换成 <strong>JSON</strong><br>这里引入一个 <strong>HTTP 消息转换器（HttpMessageConverter）</strong> 机制</p><ul><li>把 Java 对象 ➜ 转成 JSON（发送给前端）</li><li>把前端传来的 JSON ➜ 还原成 Java 对象（用在 <code>@RequestBody</code> 上）<br>默认情况下，Spring Boot 会自动引入 <strong>Jackson</strong>（一个 JSON 序列化库）来进行转换。<br>以后会详细讲解这些（挖坑</li></ul><h5 id=实践><a href=#实践 class=headerlink title=实践></a>实践</h5><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-meta>@RestController</span><br><span class=hljs-meta>@RequestMapping(&quot;/admin/user&quot;)</span>  <br><span class=hljs-meta>@Slf4j</span><br><span class=hljs-meta>@Autowired</span>  <br><span class=hljs-keyword>private</span> UserService userService;  <br><br><span class=hljs-meta>@Autowired</span>  <br><span class=hljs-keyword>private</span> UserMapper userMapper;<br><span class=hljs-meta>@PostMapping(&quot;/register&quot;)</span>  <br><span class=hljs-keyword>public</span> Result <span class="hljs-title function_">register</span><span class=hljs-params>(<span class=hljs-meta>@RequestBody</span> UserDTO userDTO, String code)</span> <span class=hljs-keyword>throws</span> BaseException &#123;  <br>    log.info(<span class=hljs-string>&quot;新增用户&#123;&#125;&quot;</span>, userDTO);  <br>    <span class=hljs-type>Integer</span> <span class=hljs-variable>result</span> <span class=hljs-operator>=</span> userService.registerUser(userDTO, code);  <br>    <span class=hljs-keyword>if</span> (result == <span class=hljs-number>1</span>) &#123;  <br>        <span class=hljs-keyword>return</span> Result.success();  <br>    &#125; <span class=hljs-keyword>else</span> <span class=hljs-keyword>return</span> Result.error(<span class=hljs-string>&quot;添加失败&quot;</span>);  <br>&#125;<br></code></pre></td></tr></table></figure><h6 id=BaseException是什么，怎么定义的？><a href=#BaseException是什么，怎么定义的？ class=headerlink title=BaseException是什么，怎么定义的？></a><strong>BaseException是什么，怎么定义的？</strong></h6><p><a href=https://www.zheep.top/posts/1585822579/ >Spring：使用自定义异常</a></p><h6 id=code是什么，干什么的？><a href=#code是什么，干什么的？ class=headerlink title=code是什么，干什么的？></a><strong>code是什么，干什么的？</strong></h6><p><a href=https://www.zheep.top/posts/1626624342/ >Spring：邮箱验证码</a></p><h6 id=为什么前面会带一个-RequestBody？><a href=#为什么前面会带一个-RequestBody？ class=headerlink title=为什么前面会带一个@RequestBody？></a><strong>为什么前面会带一个@RequestBody？</strong></h6><p>消息转换器（挖坑<br>因为前端通过 JSON 传数据时，<strong>不是传统的表单形式</strong>，Spring 不知道该怎么自动映射这些数据。<br>只有加了 <code>@RequestBody</code>，Spring 才会用 <strong>消息转换器（HttpMessageConverter）</strong>，把 JSON ➜ 转成 Java 对象。</p><figure class="highlight h"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre></td><td class=code><pre><code class="hljs h">POST /<span class=hljs-keyword>register</span><br>Content-Type: application/json<br>&#123;<br>  <span class=hljs-string>&quot;username&quot;</span>: <span class=hljs-string>&quot;岩羊&quot;</span>,<br>  <span class=hljs-string>&quot;password&quot;</span>: <span class=hljs-string>&quot;123456&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-meta>@PostMapping(&quot;/register&quot;)</span><br><span class=hljs-keyword>public</span> Result <span class="hljs-title function_">register</span><span class=hljs-params>(<span class=hljs-meta>@RequestBody</span> UserDTO userDTO, String code)</span> &#123;<br>    <span class=hljs-comment>// userDTO 就是前端传来的 JSON 自动转的对象</span><br>    <span class=hljs-comment>// code 可以是 URL 参数或 form-data 传的</span><br>&#125;<br></code></pre></td></tr></table></figure><p>接收什么数据该用什么注解呢？（挖坑</p><h4 id=Service-层><a href=#Service-层 class=headerlink title="Service 层"></a>Service 层</h4><p>Service层主要用来进行业务处理，就如同上文提到的，被Controller层进行调用，从而处理前端的各种数据，然后把处理好的数据提供给Mapper，存储到数据库中</p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-meta>@Service</span><br><span class=hljs-keyword>public</span> <span class=hljs-keyword>class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class=hljs-keyword>implements</span> <span class="hljs-title class_">UserService</span> &#123;<br><br>    <span class=hljs-meta>@Autowired</span><br>    <span class=hljs-keyword>private</span> UserMapper userMapper;<br><br>    <span class=hljs-keyword>public</span> <span class=hljs-type>boolean</span> <span class="hljs-title function_">login</span><span class=hljs-params>(String username, String password)</span> &#123;<br>        <span class=hljs-type>User</span> <span class=hljs-variable>user</span> <span class=hljs-operator>=</span> userMapper.findByUsername(username);<br>        <span class=hljs-keyword>return</span> user != <span class=hljs-literal>null</span> &amp;&amp; user.getPassword().equals(password);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-keyword>public</span> <span class=hljs-keyword>interface</span> <span class="hljs-title class_">UserService</span> &#123;  <br>    Integer <span class="hljs-title function_">registerUser</span><span class=hljs-params>(UserDTO userDTO, String code)</span> <span class=hljs-keyword>throws</span> BaseException;<br>    ...<br></code></pre></td></tr></table></figure><p>整体一看，Service层有接口和实现类</p><h5 id=为什么使用接口和实现类呢？><a href=#为什么使用接口和实现类呢？ class=headerlink title=为什么使用接口和实现类呢？></a>为什么使用接口和实现类呢？</h5><p>这是<strong>面向接口编程</strong> 的体现<br>如果你直接写死</p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-meta>@Autowired</span><br><span class=hljs-keyword>private</span> UserServiceImpl userService;<br></code></pre></td></tr></table></figure><p>这就直接具体实现了，如果将来我想要写个测试Service，就需要到处进行修改了<br>有了接口，我们可以用一个Service实现不同环境的逻辑<br>比如</p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-keyword>public</span> <span class=hljs-keyword>class</span> <span class="hljs-title class_">MockUserServiceImpl</span> <span class=hljs-keyword>implements</span> <span class="hljs-title class_">UserService</span>&#123;&#125;<span class=hljs-comment>// 测试使用</span><br><span class=hljs-keyword>public</span> <span class=hljs-keyword>class</span> <span class="hljs-title class_">RemoteUserService</span> <span class=hljs-keyword>implements</span> <span class="hljs-title class_">UserService</span>&#123;&#125;<span class=hljs-comment>// 远程服务</span><br></code></pre></td></tr></table></figure><p>由于Service层主要体现在对数据的处理方面</p><h5 id=实践-1><a href=#实践-1 class=headerlink title=实践></a>实践</h5><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-meta>@Service</span>  <br><span class=hljs-meta>@Slf4j</span>  <br><span class=hljs-keyword>public</span> <span class=hljs-keyword>class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class=hljs-keyword>implements</span> <span class="hljs-title class_">UserService</span> &#123;  <br>    <span class=hljs-meta>@Autowired</span>  <br>    RoleMapper roleMapper;  <br>    <span class=hljs-meta>@Autowired</span>  <br>    UserMapper userMapper;  <br>    <span class=hljs-meta>@Autowired</span>  <br>    <span class=hljs-keyword>private</span> RedisUtil redisUtil;  <br>  <br>    <span class=hljs-meta>@Override</span>  <br>    <span class=hljs-keyword>public</span> Integer <span class="hljs-title function_">registerUser</span><span class=hljs-params>(UserDTO userDTO, String code)</span> <span class=hljs-keyword>throws</span> BaseException &#123;  <br><span class=hljs-comment>//        格式校验  </span><br>        <span class=hljs-comment>// 校验用户名  </span><br>        <span class=hljs-keyword>if</span> (!isValidUsername(userDTO.getUsername())) &#123;  <br>            <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">BaseException</span>(<span class=hljs-string>&quot;无效的用户名，用户名必须是3-20个字符，且只能包含字母、数字、下划线和短横线。&quot;</span>);  <br>        &#125;  <br>        <span class=hljs-comment>// 校验用户名是否重复  </span><br>        <span class=hljs-type>UserPO</span> <span class=hljs-variable>temp</span> <span class=hljs-operator>=</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">UserPO</span>();  <br>        temp.setUsername(userDTO.getUsername());  <br>        <span class=hljs-keyword>if</span> (userMapper.select(temp) != <span class=hljs-literal>null</span>) <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">BaseException</span>(<span class=hljs-string>&quot;用户名&quot;</span> + userDTO.getUsername() + <span class=hljs-string>&quot;重复&quot;</span>);  <br>        <span class=hljs-comment>// 校验邮箱  </span><br>        <span class=hljs-keyword>if</span> (!isValidEmail(userDTO.getEmail())) &#123;  <br>            <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">BaseException</span>(<span class=hljs-string>&quot;无效的邮箱格式.&quot;</span>);  <br>        &#125;  <br>        <span class=hljs-comment>// 校验邮箱是否重复  </span><br>        temp = <span class=hljs-keyword>new</span> <span class="hljs-title class_">UserPO</span>();  <br>        temp.setUsername(userDTO.getEmail());  <br>        <span class=hljs-keyword>if</span> (userMapper.select(temp) != <span class=hljs-literal>null</span>) <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">BaseException</span>(<span class=hljs-string>&quot;该邮箱已注册&quot;</span>);  <br>        <span class=hljs-comment>// 校验密码  </span><br>        <span class=hljs-keyword>if</span> (!isValidPassword(userDTO.getPassword())) &#123;  <br>            <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">BaseException</span>(<span class=hljs-string>&quot;无效的密码。密码必须是6-20个字符。&quot;</span>);  <br>        &#125;  <br>        TypeReference&lt;String&gt; typeReference = <span class=hljs-keyword>new</span> <span class="hljs-title class_">TypeReference</span>&lt;String&gt;() &#123;&#125;;  <br>        <span class=hljs-comment>// 校验验证码  </span><br>        <span class=hljs-keyword>if</span> (code.isEmpty()) &#123;  <br>            <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">BaseException</span>(<span class=hljs-string>&quot;请输入验证码&quot;</span>);  <br>        &#125;  <br>        <span class=hljs-keyword>if</span> (redisUtil.get(userDTO.getEmail()+<span class=hljs-string>&quot;code&quot;</span>,typeReference) == <span class=hljs-literal>null</span>)&#123;  <br>            <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">BaseException</span>(<span class=hljs-string>&quot;验证码已过期&quot;</span>);<br>        &#125;  <br>        <span class=hljs-keyword>if</span> (!code.equals(redisUtil.get(userDTO.getEmail()+<span class=hljs-string>&quot;code&quot;</span>,typeReference))) &#123;  <br>            <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">BaseException</span>(<span class=hljs-string>&quot;验证码错误&quot;</span>);  <br>        &#125;  <br>        <span class=hljs-type>UserPO</span> <span class=hljs-variable>userPO</span> <span class=hljs-operator>=</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">UserPO</span>();  <br>        BeanUtils.copyProperties(userDTO, userPO);  <br><span class=hljs-comment>//        UUID  </span><br>        <span class=hljs-type>String</span> <span class=hljs-variable>userId</span> <span class=hljs-operator>=</span> UUID.randomUUID().toString();  <br>        userPO.setId(userId);  <br><span class=hljs-comment>//        默认头像  </span><br>        userPO.setAvatar(<span class=hljs-string>&quot;头像地址&quot;</span>);  <br><span class=hljs-comment>//        密码加密  </span><br>userPO.setPassword(DigestUtils.md5DigestAsHex(userDTO.getPassword().getBytes()));  <br><span class=hljs-comment>//        新增状态  </span><br>        userPO.setStatus(Status.NORMAL);  <br><span class=hljs-comment>//        新增身份  </span><br>        userPO.setRole(Role.ORDINARY);  <br><span class=hljs-comment>//        创建时间  </span><br>        userPO.setCreatedAt(LocalDateTime.now());  <br><span class=hljs-comment>//        修改时间  </span><br>        userPO.setUpdatedAt(LocalDateTime.now());  <br>        log.info(<span class=hljs-string>&quot;Registering user: &#123;&#125;&quot;</span>, userPO);  <br>        <span class=hljs-keyword>return</span> userMapper.registerUser(userPO);  <br>    &#125;<br></code></pre></td></tr></table></figure><p>微距了吧，其实就注册类复杂一点，因为这种操作类似于用户初始化，你要在用户注册的时候为用户添加各种默认的信息<br>看似复杂，其实总体就三步，接收Controller层的数据，处理数据，把处理好的数据交给Mapper层。<br>接受信息不必多说，在 POJO 里创建一个用户信息的类，然后直接字段注入</p><p>UserPO示例</p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-meta>@Data</span>  <br><span class=hljs-meta>@NoArgsConstructor</span>  <br><span class=hljs-meta>@AllArgsConstructor</span>  <br><span class=hljs-keyword>public</span> <span class=hljs-keyword>class</span> <span class="hljs-title class_">UserPO</span> &#123;  <br>    <span class=hljs-keyword>private</span> String id; <span class=hljs-comment>// 用户ID，使用UUID  </span><br>    <span class=hljs-keyword>private</span> String username; <span class=hljs-comment>// 用户名  </span><br>    <span class=hljs-keyword>private</span> String password; <span class=hljs-comment>// 加密后的密码  </span><br>    <span class=hljs-keyword>private</span> String email; <span class=hljs-comment>// 邮箱，唯一  </span><br>    <span class=hljs-keyword>private</span> String avatar; <span class=hljs-comment>// 头像URL  </span><br>    <span class=hljs-keyword>private</span> <span class=hljs-type>int</span> status; <span class=hljs-comment>// 用户状态，1为激活，0为禁用  </span><br>    <span class=hljs-keyword>private</span> Integer role; <span class=hljs-comment>// 用户角色，引用Role类  </span><br>    <span class=hljs-keyword>private</span> LocalDateTime createdAt; <span class=hljs-comment>// 创建时间  </span><br>    <span class=hljs-keyword>private</span> LocalDateTime updatedAt; <span class=hljs-comment>// 更新时间  </span><br>&#125;<br></code></pre></td></tr></table></figure><p>前面校验部分在讲解Mapper之前了解即可，我们只需要知道经过一系列判断之后，我们把Controller层的数据全部放到了UserPO内进行存储，然后把数据交给Mapper层进行处理。</p><p>我们看到，Controller接收数据以及把数据交给Service层使用的是UserDTO，而Service把数据交给Mapper使用的则是PO，用什么区别呢？等讲<br>POJO 层的时候进行展开。</p><p>在Service中我们知道了如何从Controller接收数据，数据处理的逻辑是什么样的，以及如何把数据传给Mapper。</p><h4 id=Mapper层><a href=#Mapper层 class=headerlink title=Mapper层></a>Mapper层</h4><h5 id=Mapper有两种和数据库交互的方法。><a href=#Mapper有两种和数据库交互的方法。 class=headerlink title=Mapper有两种和数据库交互的方法。></a>Mapper有两种和数据库交互的方法。</h5><h6 id=方式一：注解版><a href=#方式一：注解版 class=headerlink title=方式一：注解版></a>方式一：注解版</h6><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-meta>@Mapper</span><br><span class=hljs-keyword>public</span> <span class=hljs-keyword>interface</span> <span class="hljs-title class_">UserMapper</span> &#123;<br>    <span class=hljs-meta>@Select(&quot;SELECT * FROM user WHERE username = #&#123;username&#125;&quot;)</span><br>    User <span class="hljs-title function_">findByUsername</span><span class=hljs-params>(String username)</span>;<br>    <span class=hljs-meta>@Insert(&quot;INSERT INTO user (username, password) VALUES (#&#123;username&#125;, #&#123;password&#125;)&quot;)</span><br>    <span class=hljs-keyword>void</span> <span class="hljs-title function_">insertUser</span><span class=hljs-params>(User user)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>如你所见，只需要在方法上加一个注解，括号里写上相应的数据库逻辑，在被调用的时候就会执行命令。<br>如果命令很多很复杂，我们在注解括号里写不就很麻烦吗？</p><h6 id=方式二：XML-配置（更灵活）><a href=#方式二：XML-配置（更灵活） class=headerlink title="方式二：XML 配置（更灵活）"></a>方式二：XML 配置（更灵活）</h6><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-keyword>public</span> <span class=hljs-keyword>interface</span> <span class="hljs-title class_">UserMapper</span> &#123;<br>    User <span class="hljs-title function_">findByUsername</span><span class=hljs-params>(String username)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><code class="hljs xml"><span class=hljs-comment>&lt;!-- resources/mapper/UserMapper.xml --&gt;</span><br><span class=hljs-tag>&lt;<span class=hljs-name>select</span> <span class=hljs-attr>id</span>=<span class=hljs-string>&quot;findByUsername&quot;</span> <span class=hljs-attr>resultType</span>=<span class=hljs-string>&quot;User&quot;</span>&gt;</span><br>    SELECT * FROM user WHERE username = #&#123;username&#125;<br><span class=hljs-tag>&lt;/<span class=hljs-name>select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>注意，这个xml映射文件要放在resources中，和UserMapper在一个结构中才能被映射到，比如<br><code>src/main/java/com/dawnlight/chronicle_dawnlight/mapper/UserMapper.java</code><br><code>src/main/resources/com/dawnlight/chronicle_dawnlight/mapper/UserMapper.xml</code><br>其中<code>/com/dawnlight/chronicle_dawnlight/mapper/UserMapper.java</code>这一段都是一样的，不言而喻（嗯</p><p>其中的id就是对应Mapper中的方法名，resultType就是返回值类型</p><h5 id=实例><a href=#实例 class=headerlink title=实例></a>实例</h5><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><code class="hljs java"><span class=hljs-meta>@Mapper</span>  <br><span class=hljs-keyword>public</span> <span class=hljs-keyword>interface</span> <span class="hljs-title class_">UserMapper</span> &#123;  <br>    Integer <span class="hljs-title function_">registerUser</span><span class=hljs-params>(<span class=hljs-meta>@Param(&quot;user&quot;)</span> UserPO user)</span>;<br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br></pre></td><td class=code><pre><code class="hljs xml"><span class=hljs-meta>&lt;?xml version=<span class=hljs-string>&quot;1.0&quot;</span> encoding=<span class=hljs-string>&quot;UTF-8&quot;</span> ?&gt;</span><br><span class=hljs-meta>&lt;!DOCTYPE <span class=hljs-keyword>mapper</span> <span class=hljs-keyword>PUBLIC</span> <span class=hljs-string>&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class=hljs-meta>        <span class=hljs-string>&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class=hljs-tag>&lt;<span class=hljs-name>mapper</span> <span class=hljs-attr>namespace</span>=<span class=hljs-string>&quot;com.dawnlight.chronicle_dawnlight.mapper.UserMapper&quot;</span>&gt;</span><br>    <span class=hljs-tag>&lt;<span class=hljs-name>insert</span> <span class=hljs-attr>id</span>=<span class=hljs-string>&quot;registerUser&quot;</span> <span class=hljs-attr>parameterType</span>=<span class=hljs-string>&quot;com.dawnlight.chronicle_dawnlight.pojo.po.UserPO&quot;</span>&gt;</span>``<br>        INSERT INTO users (id, username, password, email, avatar, status, role, created_at, updated_at)<br>        VALUES (#&#123;user.id&#125;, #&#123;user.username&#125;, #&#123;user.password&#125;, #&#123;user.email&#125;,<br>        #&#123;user.avatar&#125;, #&#123;user.status&#125;, #&#123;user.role&#125;, #&#123;user.createdAt&#125;,<br>        #&#123;user.updatedAt&#125;);<br>    <span class=hljs-tag>&lt;/<span class=hljs-name>insert</span>&gt;</span><br></code></pre></td></tr></table></figure><p>问：如何让Spring和数据库相连接呢？<br>没错，既然需要Mapper层操作数据库，我们首先就要和数据库建立连接。<br>连接方式非常简单，涉及到了Spring的配置文件的知识（挖坑<br>这里我们简单讲述一下对数据库的配置<br>默认的配置文件叫做application.properties<br>我们可以修改为application.yml，比较简洁高效</p><figure class="highlight yml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre></td><td class=code><pre><code class="hljs yml"><span class=hljs-attr>spring:</span><br>  <span class=hljs-attr>datasource:</span><br>    <span class=hljs-attr>driver-class-name:</span> <span class=hljs-string>com.mysql.cj.jdbc.Driver</span><br>    <span class=hljs-attr>url:</span> <span class=hljs-string>jdbc:mysql://地址:端口号/构架名</span><br>    <span class=hljs-attr>username:</span> <span class=hljs-string>root</span><br>    <span class=hljs-attr>password:</span> <span class=hljs-number>104754</span><br></code></pre></td></tr></table></figure><h6 id=问：-Param是什么><a href=#问：-Param是什么 class=headerlink title=问：@Param是什么></a>问：@Param是什么</h6><p>@Param(“user”)可以理解为我们给形参 UserPO user 起了一个名字叫做user，这样我们在 xml 中看到的</p><figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><code class="hljs sql"><span class=hljs-keyword>VALUES</span> (#&#123;user.id&#125;, #&#123;user.username&#125;, #&#123;user.password&#125;, #&#123;user.email&#125;, <br>        #&#123;user.avatar&#125;, #&#123;user.status&#125;, #&#123;user.role&#125;, #&#123;user.createdAt&#125;, <br>        #&#123;user.updatedAt&#125;); <br></code></pre></td></tr></table></figure><p>这就让程序就知道了user是 你传入的 UserPO user</p><h6 id=问：-parameterType-“com-dawnlight-chronicle-dawnlight-pojo-po-UserPO”是什么><a href=#问：-parameterType-“com-dawnlight-chronicle-dawnlight-pojo-po-UserPO”是什么 class=headerlink title="问： parameterType &#x3D; “com.dawnlight.chronicle_dawnlight.pojo.po.UserPO”是什么"></a>问： parameterType &#x3D; “com.dawnlight.chronicle_dawnlight.pojo.po.UserPO”是什么</h6><p>这句话的作用是定义传入参数的类型，指定为UserPO，同理，上文代码中的 <strong>resultType&#x3D;”User”</strong> 是定义返回值类型</p><h6 id=问：namespace-“com-dawnlight-chronicle-dawnlight-mapper-UserMapper”有什么用？><a href=#问：namespace-“com-dawnlight-chronicle-dawnlight-mapper-UserMapper”有什么用？ class=headerlink title="问：namespace &#x3D; “com.dawnlight.chronicle_dawnlight.mapper.UserMapper”有什么用？"></a>问：namespace &#x3D; “com.dawnlight.chronicle_dawnlight.mapper.UserMapper”有什么用？</h6><p>这是声明一个作用域，就是告诉这个xml文件，我们要找的Mapper文件在这个路径下，这样就能够根据Mapper中的方法名自动映射了。</p><h6 id=问：这个代码返回值是什么呢？><a href=#问：这个代码返回值是什么呢？ class=headerlink title=问：这个代码返回值是什么呢？></a>问：这个代码返回值是什么呢？</h6><p>这段 MyBatis 的 <code>&lt;insert&gt;</code> 标签，对应的返回值，其实是 <strong>执行成功后受影响的行数（int 类型）</strong></p><h6 id=补充：如果我们没有在Service中设置主键，而是设置的数据库自增主键，我们如何获取到这个自增的主键呢？><a href=#补充：如果我们没有在Service中设置主键，而是设置的数据库自增主键，我们如何获取到这个自增的主键呢？ class=headerlink title=补充：如果我们没有在Service中设置主键，而是设置的数据库自增主键，我们如何获取到这个自增的主键呢？></a>补充：如果我们没有在Service中设置主键，而是设置的数据库自增主键，我们如何获取到这个自增的主键呢？</h6><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre></td><td class=code><pre><code class="hljs xml"><br><span class=hljs-tag>&lt;<span class=hljs-name>insert</span> <span class=hljs-attr>id</span>=<span class=hljs-string>&quot;registerUser&quot;</span> <span class=hljs-attr>parameterType</span>=<span class=hljs-string>&quot;UserPO&quot;</span> <span class=hljs-attr>useGeneratedKeys</span>=<span class=hljs-string>&quot;true&quot;</span> <span class=hljs-attr>keyProperty</span>=<span class=hljs-string>&quot;id&quot;</span>&gt;</span><br>    INSERT INTO users (...)<br>    VALUES (...)<br><span class=hljs-tag>&lt;/<span class=hljs-name>insert</span>&gt;</span><br></code></pre></td></tr></table></figure><p>这样 MyBatis 会自动把数据库生成的主键 ID 回填到 <code>user.id</code> 里</p><p>回到上文，我们提到了校验用户名和邮箱等数据是否已经被使用，这个逻辑在Mapper中很好实现，无非就是使用select语句对用户名和邮箱这些数据进行查询，如果查询到了，就说明已经被使用了</p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><code class="hljs java">String <span class="hljs-title function_">select</span><span class=hljs-params>(UserPO userPO)</span>;<br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br></pre></td><td class=code><pre><code class="hljs xml"><br><span class=hljs-tag>&lt;<span class=hljs-name>select</span> <span class=hljs-attr>id</span>=<span class=hljs-string>&quot;select&quot;</span> <span class=hljs-attr>resultType</span>=<span class=hljs-string>&quot;java.lang.String&quot;</span>&gt;</span><br>    select id<br>    from users<br>    <span class=hljs-tag>&lt;<span class=hljs-name>where</span>&gt;</span><br>        <span class=hljs-tag>&lt;<span class=hljs-name>if</span> <span class=hljs-attr>test</span>=<span class=hljs-string>&quot;username != null&quot;</span>&gt;</span>and username = #&#123;username&#125;<span class=hljs-tag>&lt;/<span class=hljs-name>if</span>&gt;</span><br>        <span class=hljs-tag>&lt;<span class=hljs-name>if</span> <span class=hljs-attr>test</span>=<span class=hljs-string>&quot;email != null&quot;</span>&gt;</span>and email = #&#123;email&#125;<span class=hljs-tag>&lt;/<span class=hljs-name>if</span>&gt;</span><br>    <span class=hljs-tag>&lt;/<span class=hljs-name>where</span>&gt;</span><br><span class=hljs-tag>&lt;/<span class=hljs-name>select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>这里我们把用户名查询和邮箱查询放到了一起，如果传的值是username，他就会查询username，邮箱同理</p><h6 id=和-这些是什么呢？><a href=#和-这些是什么呢？ class=headerlink title="&lt;where&gt; 和 &lt;if&gt; 这些是什么呢？"></a><code>&lt;where&gt;</code> 和 <code>&lt;if&gt;</code> 这些是什么呢？</h6><p>我们又引入了一个知识点，mybatis中的动态sql多条件查询<br>em，这篇文章讲的比我好，自行查阅<br><a target=_blank rel=noopener href=https://blog.csdn.net/qq_43049310/article/details/110007299>MyBatis动态SQL 多条件查询</a></p><p>以上内容大致讲述了三层架构的作用以及具体代码的含义，当然，这只是Spring内容的一小部分。<br>按照以上操作可以完成一个基础的注册流程。<br>更多细节以后会更新，已经标注了（挖坑</p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class=category-chains><span class=category-chain><a href=/categories/code/ class=category-chain-item>code</a></span></span></div><div class=post-meta><i class="iconfont icon-tags"></i> <a href=/tags/%E7%BD%91%E7%AB%99/ class=print-no-link>#网站</a></div></div><div class="license-box my-3"><div class=license-title><div>Spring：整体思路讲解</div><div>https://www.zheep.top/posts/3458421192/</div></div><div class=license-meta><div class=license-meta-item><div>作者</div><div>西行寺岩羊</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2025年5月6日</div></div><div class=license-meta-item><div>许可协议</div><div><a class=print-no-link target=_blank href=https://creativecommons.org/licenses/by/4.0/ ><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-cc-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href=/posts/1585822579/ title=Spring：使用自定义异常><i class="iconfont icon-arrowleft"></i> <span class=hidden-mobile>Spring：使用自定义异常</span> <span class=visible-mobile>上一篇</span></a></article><article class="post-next col-6"><a href=/posts/1403506308/ title="书记：《德米安：埃米尔 · 辛克莱彷徨少年时》"><span class=hidden-mobile>书记：《德米安：埃米尔 · 辛克莱彷徨少年时》</span> <span class=visible-mobile>下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id=comments><script type=text/javascript>Fluid.utils.loadComments("#comments",function(){var t="dark"===document.documentElement.getAttribute("data-user-color-scheme")?"github-dark":"github-light",e=(window.UtterancesThemeLight="github-light",window.UtterancesThemeDark="github-dark",document.createElement("script"));e.setAttribute("src","https://utteranc.es/client.js"),e.setAttribute("repo","zheep1209/comments"),e.setAttribute("issue-term","pathname"),e.setAttribute("label","utterances"),e.setAttribute("theme",t),e.setAttribute("crossorigin","anonymous"),document.getElementById("comments").appendChild(e)})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class=sidebar style=margin-left:-1rem><div id=toc><p class=toc-header><i class="iconfont icon-list"></i> <span>目录</span></p><div class=toc-body id=toc-body></div></div></aside></div></div></div><a id=scroll-top-button aria-label=TOP href=# role=button><i class="iconfont icon-arrowup" aria-hidden=true></i></a><div class="modal fade" id=modalSearch tabindex=-1 role=dialog aria-labelledby=ModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-lg" role=document><div class=modal-content><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type=button id=local-search-close class=close data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type=text id=local-search-input class="form-control validate"> <label data-error=x data-success=v for=local-search-input>关键词</label></div><div class=list-group id=local-search-result></div></div></div></div></div></main><footer><div class=footer-inner><div class=footer-content><div class=home><div class=left><p style=font-size:20px;margin-top:0>© 2025 西行寺岩羊のblog</p><p>愿你被世界温柔以待</p><span id=timeDate>天数载入中</span><span id=times>...</span><br>Powered by <a href=https://hexo.io target=_blank rel="nofollow noopener"><span>Hexo</span></a> & <a href=https://github.com/fluid-dev/hexo-theme-fluid target=_blank rel="nofollow noopener"><span>Fluid</span></a></div><div class=right><div class=r1><div><a href=https://www.zheep.top/atom.xml target=_blank><span>Rss</span></a></div><div><a href=https://www.foreverblog.cn/go.html target=_blank rel="nofollow noopener"><span>虫洞-随机访问十年之约成员博客</span></a></div><div><a href=https://www.travellings.cn/go.html target=_blank rel="nofollow noopener"><span>开往-友链接力</span></a></div><div><a href=https://www.blogsclub.org/go target=_blank rel="nofollow noopener"><span>空间穿梭</span></a></div><div><a href=https://suiji.ru/ target=_blank rel="nofollow noopener"><span>随机博客</span></a></div><div><a href=https://www.boyouquan.com/planet-shuttle target=_blank rel="nofollow noopener"><span>星球穿梭</span></a></div><div><a href=http://lab.zheep.top/ target=_blank rel="nofollow noopener"><span>岩羊的实验室</span></a></div></div><div class=r2><a title="无聊湾 🥱 The Boring Bay" target=_blank rel=noopener href=https://boringbay.com><img height=32px alt="无聊湾 🥱 The Boring Bay" src=https://boringbay.com/api/badge/www.zheep.top></a><br><a href=https://www.blogsclub.org/rank.html target=_blank><img src=https://www.blogsclub.org/badge/www.zheep.top alt="blogs club" style=height:32px!important></a><br><a href="https://icp.gov.moe/?keyword=20258844" target=_blank>萌ICP备20258844号</a></div></div></div></div><div class=statistics><span id=busuanzi_container_site_pv style=display:none>总访问量 <span id=busuanzi_value_site_pv></span> 次 </span><span id=busuanzi_container_site_uv style=display:none>总访客数 <span id=busuanzi_value_site_uv></span> 人</span></div></div></footer><script src=https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js></script><link rel=stylesheet href=https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src=https://lib.baomitu.com/jquery/3.6.4/jquery.min.js></script><script src=https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js></script><script src=/js/events.js></script><script src=/js/plugins.js></script><script src=https://lib.baomitu.com/typed.js/2.0.12/typed.min.js></script><script>(t=>{var e=Fluid.plugins.typing;(t=t.getElementById("subtitle"))&&e&&e(t.getAttribute("data-typed-text"))})((window,document))</script><script src=/js/img-lazyload.js></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length)&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible")}))})</script><script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script src=/js/local-search.js></script><script defer=defer src=https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script src=/custom/js/create-time.js></script><script src=/custom/js/label-page.js></script><script src=/custom/js/jump.js></script><script src=/custom/js/background.js></script><script src=/custom/js/after-generate.js></script><script src=/js/boot.js></script><noscript><div class=noscript-warning>博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript><script src=https://cdn.jsdelivr.net/npm/echarts@5.5.1/dist/echarts.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){var t=document.getElementById("heatmapChart");if(t){let e=echarts.init(t,"light");var a=[18,18];let i=(e=>{let i={};return e.forEach(([e,t])=>{var[a]=e.split("-").map(Number);i[a]||(i[a]=[]),i[a].push([e,t])}),i})([["2024-05-20",1],["2024-06-29",1],["2024-10-03",1],["2024-11-16",1],["2024-11-18",1],["2024-11-21",1],["2024-11-25",1],["2024-11-26",1],["2024-11-27",1],["2024-11-28",1],["2024-11-29",2],["2024-11-30",2],["2024-12-01",2],["2024-12-02",1],["2024-12-04",1],["2024-12-08",2],["2024-12-09",1],["2024-12-14",1],["2025-03-12",2],["2025-03-13",1],["2025-03-16",1],["2025-04-18",28],["2025-04-23",1],["2025-04-28",1],["2025-05-06",1],["2025-05-07",1],["2025-05-08",2],["2025-05-09",1],["2025-05-11",1],["2025-05-14",2],["2025-05-17",1],["2025-05-18",1],["2025-05-21",1],["2025-05-30",1],["2025-06-04",1],["2025-06-07",1],["2025-08-03",1],["2025-10-12",1]]),n=Object.keys(i).reverse();var o=parseInt(t.getAttribute("year"))||(new Date).getFullYear(),t=n[n.length-1],l=n[0];(o<t||l<o)&&(o=l),console.log("[hexo-graph]generateHeatmapChart|initYear:",o,"minYear:",t,"maxYear:",l),e.setOption({grid:{},tooltip:{position:"top",formatter:e=>`${e.value[0]}: ${e.value[1]} Articles`},calendar:{top:"10%",left:"left",right:"8%",range:o,cellSize:a,splitLine:{lineStyle:{color:"#E0E0E0",width:1}},itemStyle:{borderWidth:1,borderColor:"#E0E0E0"},dayLabel:{show:!1},monthLabel:{show:!0},yearLabel:{show:!1}},visualMap:{show:!0,right:"8%",bottom:"5%",type:"piecewise",orient:"horizontal",text:["More","Less"],min:0,max:Math.max(...i[o].map(e=>e[1])),inRange:{color:["#ACE7AE","#69C16D","#549F57"]}},legend:{type:"scroll",icon:"none",data:n,orient:"vertical",top:"5%",right:"right",itemWidth:20,itemHeight:20,itemGap:10,pageIconSize:10,pageTextStyle:{fontSize:14},selectedMode:"single"},series:n.map(e=>({type:"heatmap",coordinateSystem:"calendar",data:i[e],name:e,emphasis:{disabled:!0},silent:e!==o}))}),e.dispatchAction({type:"legendSelect",name:o}),e.on("legendselectchanged",function(t){console.log("[hexo-graph]generateHeatmapChart|legendselectchanged:",t);let a=Object.keys(t.selected).find(e=>t.selected[e]);a&&i[a]&&e.setOption({calendar:{range:a},visualMap:{max:Math.max(...i[a].map(e=>e[1]))},series:n.map(e=>({type:"heatmap",coordinateSystem:"calendar",data:i[e],name:e,emphasis:{disabled:!0},silent:e!==a}))})}),e.on("click",function(e){var t;"series"===e.componentType&&([e,t]=e.value[0].split("-"),window.location.href="/archives/"+e+"/"+t)})}})</script><script>document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("monthlyChart");e&&((e=echarts.init(e,"light")).setOption({xAxis:{type:"category",data:["2024-05","2024-06","2024-10","2024-11","2024-12","2025-03","2025-04","2025-05","2025-06","2025-08","2025-10"],axisLabel:{fontSize:14,fontWeight:"bold",fontFamily:"Microsoft YaHei, SimSun, serif"}},yAxis:{type:"value",splitLine:{lineStyle:{type:"dashed",color:"#ccc"}}},series:[{name:"Articles",type:"line",data:[1,1,1,11,8,4,30,12,2,1,1],smooth:!0,lineStyle:{color:"#5470C6",width:2},itemStyle:{color:"#5470C6"},areaStyle:{color:"rgba(84, 112, 198, 0.4)"},symbolSize:10,label:{show:!0,position:"top",formatter:e=>e.value,fontSize:14,color:"#000",fontWeight:"bold",fontFamily:"Microsoft YaHei, SimSun, serif"}}]}),e.on("click",function(e){var[e,t]=e.name.split("-");window.location.href="/archives/"+e+"/"+t}))})</script><script>document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("tagsChart");e&&((e=echarts.init(e,"light")).setOption({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},series:[{type:"pie",radius:"60%",data:[{name:"数据结构",value:12},{name:"英语/词性",value:10},{name:"英语/句子",value:7},{name:"英语/词性/动词",value:7},{name:"读书笔记",value:5},{name:"网站",value:5},{name:"记录",value:4},{name:"心理",value:3}],label:{position:"outside",formatter:"{b} {c} ({d}%)",fontSize:14,fontWeight:"bold",fontFamily:"Microsoft YaHei, SimSun, serif"},color:["#5470C6","#91CC75","#FAC858","#EE6666","#73C0DE","#3BA272","#FC8452","#9A60B4"],labelLine:{show:!0}}],legend:{bottom:"0",left:"center",data:[{name:"数据结构",value:12},{name:"英语/词性",value:10},{name:"英语/句子",value:7},{name:"英语/词性/动词",value:7},{name:"读书笔记",value:5},{name:"网站",value:5},{name:"记录",value:4},{name:"心理",value:3}].map(e=>e.name),textStyle:{fontSize:14,fontWeight:"bold",fontFamily:"Microsoft YaHei, SimSun, serif"}}}),e.on("click",function(e){window.location.href="/tags/"+e.name}))})</script><script>document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("categoriesChart");e&&((e=echarts.init(e,"light")).setOption({xAxis:{type:"value",splitLine:{lineStyle:{type:"dashed",color:"#ccc"}}},yAxis:{type:"category",data:[{name:"code",value:30},{name:"英语",value:25},{name:"记录",value:5},{name:"阅读",value:5},{name:"游戏",value:3}].map(e=>e.name).reverse(),axisLabel:{fontSize:14,fontWeight:"bold",fontFamily:"Microsoft YaHei, SimSun, serif"}},series:[{name:"Category Count",type:"bar",data:[{name:"code",value:30},{name:"英语",value:25},{name:"记录",value:5},{name:"阅读",value:5},{name:"游戏",value:3}].map(e=>e.value).reverse(),label:{show:!0,position:"right",formatter:e=>e.value,fontSize:14,color:"#000",fontWeight:"bold",fontFamily:"Microsoft YaHei, SimSun, serif"},itemStyle:{color:new echarts.graphic.LinearGradient(0,0,1,0,[{offset:0,color:"#91CC75"},{offset:1,color:"#73C0DE"}])}}]}),e.on("click",function(e){window.location.href="/categories/"+e.name}))})</script><script>document.addEventListener("DOMContentLoaded",function(){var t=document.getElementById("categoriesTreeChart");t&&((t=echarts.init(t,"light")).setOption({title:{text:"操作提示：单击展开分类，双击进入具体分类页面",textStyle:{fontSize:12,color:"#999",fontWeight:"normal"},bottom:0,left:"center"},tooltip:{trigger:"item",triggerOn:"mousemove"},series:[{type:"tree",data:[{name:"Categories",children:[{name:"code",children:[{name:"游戏",children:[{name:"记录",children:[],count:1,path:"code/游戏/记录"}],count:1,path:"code/游戏"}],count:30,path:"code"},{name:"游戏",children:[],count:2,path:"游戏"},{name:"英语",children:[],count:25,path:"英语"},{name:"笔记",children:[],count:1,path:"笔记"},{name:"记录",children:[],count:4,path:"记录"},{name:"思考",children:[],count:1,path:"思考"},{name:"心理",children:[],count:1,path:"心理"},{name:"阅读",children:[],count:5,path:"阅读"}],count:0,path:""}],initialTreeDepth:-1,top:"5%",bottom:"10%",left:"0%",right:"0%",symbolSize:15,layout:"orthogonal",orient:"TB",itemStyle:{color:"#91CC75",borderColor:"#73C0DE"},label:{position:"bottom",verticalAlign:"middle",align:"center",fontSize:14,distance:28,formatter:function(t){return t.data.name+(t.data.count?" ("+t.data.count+")":"")}},leaves:{label:{position:"top",verticalAlign:"middle",align:"center"}},emphasis:{focus:"descendant"},expandAndCollapse:!0}]}),t.on("dblclick",function(t){t.data&&t.data.path&&(window.location.href="/categories/"+t.data.path)}))})</script></body></html>